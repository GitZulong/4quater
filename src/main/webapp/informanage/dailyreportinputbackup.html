<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>日报录入</title>
<script src="../../../miniui/boot.js" type="text/javascript"></script>
<script src="../test_data.js" type="text/javascript"></script>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<style type="text/css">
body {
	margin: 0;
	padding: 0;
	border: 0;
	width: 100%;
	height: 100%;
	overflow: hidden;
}

.add_new {
	background: url(../image/新增.png) no-repeat
}

.del_new {
	background: url(../image/删除.png) no-repeat
}

.save_new {
	background: url(../image/保存.png) no-repeat
}
</style>
</head>
<body>
	<div style="width: 100%;">
		<div class="mini-toolbar" style="border-bottom: 0; padding: 0px;">
			<table style="width: 100%;">
				<tr>
					<td style="width: 50%;"><a class="mini-button"
						iconCls="icon-add" onclick="addRow()" plain="true" tooltip="增加...">增加</a>
						<span class="separator"></span> <a class="mini-button"
						iconCls="icon-remove" onclick="removeRow()" tooltip="删除..."
						plain="true">删除</a> <span class="separator"></span> <a
						class="mini-button" iconCls="icon-save" onclick="saveData()"
						tooltip="保存..." plain="true">保存</a></td>
					<td><label id="lbl_reportdesc">报告周期</label></td>

				</tr>
			</table>
		</div>
	</div>
	<div class="mini-fit">
		<div id="dailyreport_input" class="mini-datagrid"
			style="width: 100%; height: 100%;" sizeList="[100,200,300,500]"
			url="/main/new" idField="id" allowResize="true" pageSize="20"
			allowCellEdit="true" allowCellSelect="true" multiSelect="true"
			allowAlternating="true" allowCellWrap="true"
			editNextOnEnterKey="true" editNextRowCell="true"
			showHeader="true" title="当天完成工作内容">
			<div property="columns">
				<div type="indexcolumn"></div>
				<div type="checkcolumn"></div>
				
        <div name="project_id" field="project_id" width="50" align="center"  headerAlign="center" allowSort="true" vtype="required" renderer="onrerender_project">项目名称
            <input property="editor" class="mini-combobox"   style="width:100%;" nullItemText="请选择..." showNullItem="true"  emptyText="请选择..." allowInput="true" url="/main/getsystem" textField="text" valueField="id"/>
        </div>
				<div field="product_id" width="100" headerAlign="center"
					align="center" renderer="onrelevanceprinciple4">产品名称</div>

				<div field="work_contents" allowSort="true" width="200"
					headerAlign="center" vtype="required">
					工作内容简述 <input property="editor" class="mini-textarea"
						style="width: 100%;" />
				</div>
				<div field="work_detail" allowSort="true" width="400"
					headerAlign="center" vtype="required">
					工作详述 <input property="editor" class="mini-textarea"
						style="width: 100%;" />
				</div>
				<div field="finish_percent" allowSort="true" width="40"
					headerAlign="center" vtype="required">完成比例</div>
				<div field="delay_reason" allowSort="true" width="40"
					headerAlign="center" vtype="required">延迟原因</div>

				<div field="accord_yesterday" allowSort="true" width="40"
					headerAlign="center" vtype="required">对应计划</div>


				<div field="impo_level" allowSort="true" width="40"
					headerAlign="center" vtype="required">重要级别</div>
			</div>
		</div>
	</div>

</body>
<script type="text/javascript">
	$(function() {
		//alert("init ");
		//用于编写jquery的 代码
		var lbl_reportdesc = $("#lbl_reportdesc");
		var title_id = $.ajax({
			url : "/main/titleid",
			async : false
		}).responseText;
		lbl_reportdesc.text(title_id);
	});

	mini.parse();
    var grid = mini.get("dailyreport_input");
	function addRow() {
			var newRow = {
			project_id : "1",
			product_id : "1",
			work_contents : "与客户沟通，1104统计报送的需求",
			work_detail : "1.个人账户数据报送，处理校验不通过的异常数据，根据前置机反馈信息分开重报存量与增量的开户数据。另外，查看前面重报开户数据是否重报成功，根据反馈情况将不成功数据进行销户与开户的重报，成功的只要重报变更销户数据就可以。",
			finish_percent : "江西农信监管报送平台",
			delay_reason : "没时间弄",
			accord_yesterday : "2",
			impo_level : "1"
		};
		grid.addRow(newRow, 0);
		grid.beginEditCell(newRow, "");
	}
	
    function onrerender_project(e) {
    	
	        var relevanceprinciple = mini.decode($.ajax({
	            url: "/main/getsystem",
	            async: false
	        }).responseText);
	        for (var i = 0, l = relevanceprinciple.length; l > i; i++) {
	            var g = relevanceprinciple[i];
	            if (g.id== e.value) return g.text;
	        }
	        return "";
	    }
</script>
</html>
